fragment Product on Product {
  id
  name
  name_slug
  description
  service_name_slug
  reference_enabled
  reference_label
  reference_hint
  price_fixed
  price
  gateway_account {
    id
    service {
      id
      name
    }
  }
}

fragment ProductPayment on ProductPayment {
  id
  reference
  amount
  status
  next_url
  product {
    ...Product
  }
}

query GetProduct($serviceNameSlug: String!, $nameSlug: String!) {
  product(serviceNameSlug: $serviceNameSlug, nameSlug: $nameSlug)
    @rest(
      type: "Product"
      path: "/internal/products/products/{args.serviceNameSlug}/{args.nameSlug}"
    ) {
    ...Product
  }
}

query GetPayment($id: ID!) {
  payment(id: $id)
    @rest(
      type: "ProductPayment"
      path: "/internal/products/product-payments/{args.id}"
    ) {
    ...ProductPayment
  }
}

mutation CreatePayment(
  $serviceNameSlug: String!
  $nameSlug: String!
  $input: CreatePaymentInput!
) {
  payment: createPayment(
    serviceNameSlug: $serviceNameSlug
    nameSlug: $nameSlug
    input: $input
  )
    @rest(
      type: "ProductPayment"
      path: "/internal/products/products/{args.serviceNameSlug}/{args.nameSlug}/payments"
      method: "POST"
    ) {
    ...ProductPayment
  }
}

mutation UpdatePayment($id: ID!, $input: UpdatePaymentInput!) {
  payment: updatePayment(id: $id, input: $input)
    @rest(
      type: "ProductPayment"
      path: "/internal/products/product-payments/{args.id}"
      method: "PUT"
    ) {
    ...ProductPayment
  }
}

mutation SubmitPayment($id: ID!, $input: SubmitPaymentInput!) {
  payment: submitPayment(id: $id, input: $input)
    @rest(
      type: "ProductPayment"
      path: "/internal/products/product-payments/{args.id}/submit"
      method: "POST"
    ) {
    ...ProductPayment
  }
}
